require(tidymodels)
require(data.table)
require(data.tree)
require(DataExplorer)
require(C50)
require(indicspecies)
require(doParallel)
require(philentropy)
require(dplyr)
source("CodeUsingTreeFunctions.R")
head(Hier.data)
dim(Hier.data)
names(Hier.data)
sapply(Hier.data, function(x) length(unique(x)))
# Class
uniqueClasses <- unique(Hier.data$Class)
print(uniqueClasses)
# SiteUnits_per_Class_1 <- lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, c)
SiteUnits_per_Class$SiteUnit[[3]] %>% unique %>% length
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, c)
SiteUnits_per_Class$SiteUnit[1] %>% length
SiteUnits_per_Class$SiteUnit[[1]] %>% length
SiteUnits_per_Class$SiteUnit
SiteUnits_per_Class$SiteUnit[1]
SiteUnits_per_Class$SiteUnit[1] %>% unique
SiteUnits_per_Class$SiteUnit[[1]] %>% unique
SiteUnits_per_Class$Class[[1]] %>% unique
SiteUnits_per_Class$SiteUnit[[1]] %>% length
View(SiteUnits_per_Class)
uniqueClasses <- unique(Hier.data$Class)
print(uniqueClasses)
SiteUnits_per_Class_1 <- lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
uniqueClasses <- unique(Hier.data$Class)
print(uniqueClasses)
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, c)
SiteUnits_per_Class$SiteUnit[[1]] %>% length
SiteUnits_per_Class$SiteUnit[[1]] %>% length
SiteUnits_per_Class$SiteUnit[[1]]
SiteUnits_per_Class$SiteUnit[1] %>% length
SiteUnits_per_Class$SiteUnit[[3]] %>% length
SiteUnits_per_Class$SiteUnit[[3]]
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, c)
SiteUnits_per_Class$SiteUnit[[3]]
SiteUnits_per_Class$SiteUnit[[3]] %>% typeof
length(SiteUnits_per_Class$SiteUnit[[3]])
require(dplyr)
length(SiteUnits_per_Class$SiteUnit[[3]])
SiteUnits_per_Class$SiteUnit[[3]] %>% unique
SiteUnits_per_Class_1 <- lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
uniqueClasses <- unique(Hier.data$Class)
print(uniqueClasses)
SiteUnits_per_Class_1 <- lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
head(Hier.data)
dim(Hier.data)
names(Hier.data)
sapply(Hier.data, function(x) length(unique(x)))
print(uniqueClasses)
SiteUnits_per_Class_1 <- lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
uniqueClasses <- unique(Hier.data$Class)
print(uniqueClasses)
lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
knitr::opts_chunk$set(echo = FALSE)
require(tidyverse)
require(tidymodels)
require(data.table)
require(data.tree)
require(DataExplorer)
require(C50)
require(indicspecies)
require(doParallel)
require(philentropy)
require(dplyr)
source("CodeUsingTreeFunctions.R")
knitr::opts_chunk$set(echo = FALSE)
require(tidyverse)
require(tidymodels)
require(data.table)
require(data.tree)
require(DataExplorer)
require(C50)
require(indicspecies)
require(doParallel)
require(philentropy)
require(dplyr)
source("CodeUsingTreeFunctions.R")
source("./_functions/_TabletoTree.R")
source("./_functions/_TreetoTable.R")
source("./_functions/_VegdatSUsummary.R")
source("./_functions/_spp_importance.R")
head(Hier.data)
dim(Hier.data)
names(Hier.data)
sapply(Hier.data, function(x) length(unique(x)))
# Class
uniqueClasses <- unique(Hier.data$Class)
print(uniqueClasses)
lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
#x <- Hier.data[Class %in% uniqueClasses, ] %>% dplyr::select(SiteUnit)
#print(x)
#Hier.data %>% group_by(Class) %>% select(SiteUnit)
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, c)
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, c)
View(Hier.data)
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, c)
SiteUnits_per_Order <- aggregate(SiteUnit ~ Order, data = Hier.data, c)
SiteUnits_per_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, c)
SiteUnits_per_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, set)
SiteUnits_per_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, set(c))
SiteUnits_per_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, c)
SiteUnits_per_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, unique)
View(SiteUnits_per_Suborder)
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, unique)
SiteUnits_per_Class_1 <- lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
View(SiteUnits_per_Class)
SiteUnits_per_Class_1 <- lapply(uniqueClasses, function(x) unique(Hier.data %>% filter(Class == x) %>% select(SiteUnit)))
View(SiteUnits_per_Class_1)
SiteUnits_per_Class_1$SiteUnits[[1]]
SiteUnits_per_Class_1$SiteUnits[[3]]
SiteUnits_per_Class_1$SiteUnits[[4]]
SiteUnits_per_Class_1$SiteUnits[4]
SiteUnits_per_Class_1
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, unique) %>% length
aggregate(SiteUnit ~ Class, data = Hier.data, unique) %>% length
SiteUnits_per_Class_1
print(uniqueClasses)
aggregate(SiteUnit ~ Class, data = Hier.data, unique)
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, unique)
SiteUnits_per_Order <- aggregate(SiteUnit ~ Order, data = Hier.data, unique)
SiteUnits_per_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, unique)
print(SiteUnits_per_Class)
View(SiteUnits_per_Class)
SiteUnits_per_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, unique)
SiteUnits_per_Order <- aggregate(SiteUnit ~ Order, data = Hier.data, unique)
SiteUnits_per_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, unique)
sapply(Hier.data, function(x) length(unique(x)))
View(vegdat_test)
knitr::opts_chunk$set(echo = FALSE)
require(tidyverse)
require(tidymodels)
require(data.table)
require(data.tree)
require(DataExplorer)
require(C50)
require(indicspecies)
require(doParallel)
require(philentropy)
require(dplyr)
source("./_functions/_TabletoTree.R")
source("./_functions/_TreetoTable.R")
source("./_functions/_VegdatSUsummary.R")
source("./_functions/_spp_importance.R")
SS.names <- unique(SUTab$SiteUnit)
SUTab <- fread("./BEC_ReportR/ALLBECSU_2021_SU.csv")
###SU table
SUTab <- fread("./BEC_ReportR/ALLBECSU_2021_SU.csv")
SS.names <- unique(SUTab$SiteUnit)
SUTab <- fread("./BEC_ReportR/Classification_tables/ALLBECSU_2021_SU.csv")
#SUTab <- fread("./inputs/BECv13Analysis_Forest_17Sept2021_SU.csv")
SUTab$SiteUnit <-  trimws(SUTab$SiteUnit)
SS.names <- unique(SUTab$SiteUnit)
View(SiteUnits_per_Class)
View(SUTab)
View(SUTab)
match(x, df)
match(x, df$col_1)
df = data.frame(col_1, col_2)
col_1 <- c(1,2,3,4,5)
col_2 <- c("A", "B", "C", "D", "E")
df = data.frame(col_1, col_2)
x <- c(1,3,2,1,5,3,2)
match(x, df$col_1)
match(x, df$col_1)
match(x, df)
match(x, df$col_2)
match(x, df$col_1)
x %in% df
x[x %in% df]
x[x %in% c(col_1, col_2)]
x[x %in% c(col_2, col_1)]
x[x %in% c(col_2, col_1)]
x %in% df
x %in% df$col_1
sstr <- c("c","ab","B","bba","c",NA,"@","bla","a","Ba","%")
sstr[sstr %in% c(letters, LETTERS)]
sstr[sstr %in% c(letters, LETTERS)]
letters
LETTERS
sstr[sstr %in% c(letters, LETTERS)]
match(4,x)
match(x,4)
match(x,4)
match(4,x)
match(3,x)
df[df$col_1 %in% x]
df$col_1 %in% x
df[df$col_1 %in% x]
df[df$col_1 %in% x]
df[df$col_1 %in% x]
df$col_1 %in% x
df$col_2[df$col_1 %in% x]
df$col_2[df$col_1 %in% x]
df[df$col_1 %in% x]
df$col_1 %in% x
df = data.frame(col_1, col_2)
df
df$col_2[df$col_1 %in% x]
SUTab$PlotNumber[SUTab$SiteUnit %in% SiteUnits_per_Class$SiteUnit]
PlotNumbers_in_Class <- SUTab$PlotNumber[SUTab$SiteUnit %in% SiteUnits_in_Class$SiteUnit]
SiteUnits_in_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, unique)
SiteUnits_in_Order <- aggregate(SiteUnit ~ Order, data = Hier.data, unique)
SiteUnits_in_Suborder <- aggregate(SiteUnit ~ Suborder, data = Hier.data, unique)
```{r Look up corresponding plots}
SUTab <- fread("./BEC_ReportR/Classification_tables/ALLBECSU_2021_SU.csv")
SUTab$SiteUnit <-  trimws(SUTab$SiteUnit)
PlotNumbers_in_Class <- SUTab$PlotNumber[SUTab$SiteUnit %in% SiteUnits_in_Class$SiteUnit]
PlotNumbers_in_Order <- SUTab$PlotNumber[SUTab$SiteUnit %in% SiteUnits_in_Order$SiteUnit]
PlotNumbers_in_Suborder <- SUTab$PlotNumber[SUTab$SiteUnit %in% SiteUnits_in_Suborder$SiteUnit]
PlotNumbers_in_Class
View(SiteUnits_in_Class)
SiteUnits_in_Class$PlotNumber <- SUTab$PlotNumber[SUTab$SiteUnit %in% SiteUnits_in_Class$SiteUnit]
col_1 <- c("A", "B", "C", "D")
col_2 <- c(1,2,3,4)
df <- data.frame(col_1, col_2)
col_1 <- c("A", "B", "C", "D")
col_2 <- c(1,2,3,4)
df <- data.frame(col_1, col_2)
col_1 <- c("A", "B", "C", "D")
col_y <- c("a", "b", "c", "d")
df2 <- data.frame(col_1, coly_y)
jointdataset <- merge(df, df2, by = 'col_1')
df2 <- data.frame(col_1, coly_y)
col_y <- c("a", "b", "c", "d")
df2 <- data.frame(col_1, coly_y)
col_1 <- c("A", "B", "C", "D")
col_2 <- c(1,2,3,4)
df <- data.frame(col_1, col_2)
col_y <- c("a", "b", "c", "d")
df2 <- data.frame(col_1, coly_y)
df2 <- data.frame(col_1, col_y)
jointdataset <- merge(df, df2, by = 'col_1')
print(jointdataset)
col_y <- c("a", "b", "c", "d", "e", "a", "f", "d")
df2 <- data.frame(col_1, col_y)
jointdataset <- merge(df, df2, by = 'col_1')
print(jointdataset)
print(df2)
col_1 <- c("A", "B", "C", "D")
col_2 <- c(1,2,3,4)
df <- data.frame(col_1, col_2)
col_y <- c("A", "D", "C", "B", "E", "F", "A", "D")
df2 <- data.frame(col_1, col_y)
jointdataset <- merge(df, df2, by = 'col_1')
print(df2)
print(jointdataset)
col_1 <- c("A", "D", "C", "B", "E", "F", "A", "D")
col_2 <- c("a", "d", "c", "b", "e", "f", "a", "d")
df2 <- data.frame(col_1, col_y)
jointdataset <- merge(df, df2, by = 'col_1')
print(df2)
print(jointdataset)
print(jointdataset)
print(df2)
df2 <- data.frame(col_1, col_2)
jointdataset <- merge(df, df2, by = 'col_1')
print(df2)
print(jointdataset)
jointdataset <- merge(Hier.data, SUTab, by = SiteUnit)
jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
print(jointdataset)
View(jointdataset)
SUTab$SiteUnit %>% unique %>% length
SUTab$SiteUnit %>% length
SUTab$PlotNumber %>% unique %>% length
SUTab$PlotNumber %>% length
SUTab$SiteUnit %>% unique %>% length
SUTab$SiteUnit %>% length
SUTab$PlotNumber %>% unique %>% length
SUTab$PlotNumber %>% length
clear
clean
SiteUnits_in_Class <- aggregate(SiteUnit ~ Class, data = Hier.data, unique)
View(SiteUnits_in_Class)
print(jointdataset)
SUTab$SiteUnit %>% unique %>% length
SiteUnits <- c("A", "B", "C", "D")
Order <- c(1,2,3,4)
df <- data.frame(SiteUnits, Order)
SiteUnits <- c("A", "D", "C", "B", "E", "F", "A", "D")
Plots <- c("a", "d", "c", "b", "e", "f", "a", "d")
df2 <- data.frame(SiteUnits, Plots)
jointdataset <- merge(df, df2, by = 'col_1')
print(df2)
jointdataset <- merge(df, df2, by = 'col_1')
jointdataset <- merge(df, df2, by = 'col_1')
jointdataset <- merge(df, df2, by = 'SiteUnits')
jointdataset <- merge(df, df2, by = 'col_1')
jointdataset <- merge(df, df2, by = 'SiteUnits')
View(jointdataset)
print(jointdataset)
SUTab$SiteUnit %>% unique %>% length
SUTab$SiteUnit %>% length
Hier.data$SiteUnit %>% unique %>% length
Hier.data$SiteUnit %>% length
Hier.data$Order %>% unique %>% length
Hier.data$Order %>% length
left_join_dataset = left_join(df, df2, by = 'SiteUnits')
print(left_join())
print(left_join_dataset)
left_join_dataset = left_join(df, df2, by = 'SiteUnits')
print(left_join_dataset)
jointdataset <- merge(df, df2, by = 'SiteUnits')
print(jointdataset)
SiteUnits <- c("A", "B", "C", "D", "Z")
Order <- c(1,2,3,4, 26)
df <- data.frame(SiteUnits, Order)
SiteUnits <- c("A", "D", "C", "B", "E", "F", "A", "D")
Plots <- c("a", "d", "c", "b", "e", "f", "a", "d")
df2 <- data.frame(SiteUnits, Plots)
jointdataset <- merge(df, df2, by = 'SiteUnits')
print(df2)
print(jointdataset)
```{r}
SUTab$SiteUnit %>% unique %>% length
SUTab$SiteUnit %>% length
SUTab$PlotNumber %>% unique %>% length
SUTab$PlotNumber %>% length
Hier.data$SiteUnit %>% unique %>% length
Hier.data$SiteUnit %>% length
Hier.data$Order %>% unique %>% length
Hier.data$Order %>% length
```{r}
jointdataset <- merge(df, df2, by = 'SiteUnits')
print(jointdataset)
left_join_dataset = left_join(df, df2, by = 'SiteUnits')
print(left_join_dataset)
View(jointdataset)
jointdataset <- merge(df, df2, by = 'SiteUnits')
Hier.data
SUTab
jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
View(jointdataset)
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
View(jointdataset)
Hier.data
SUTab
jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
Hier.data <- Hier.data[order(jointdataset$SiteUnit),]
View(jointdataset)
View(Hier.data)
Hier.data <- Hier.data[order(jointdataset$SiteUnit),]
Hier.data
SUTab
jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
Hier.data <- Hier.data[order(jointdataset$SiteUnit),]
View(jointdataset)
View(Hier.data)
Hier.data
SUTab
jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
Hier.data <- Hier.data[order(Hier.dat$SiteUnit),]
Hier.data
SUTab
jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
Hier.data <- Hier.data[order(Hier.data$SiteUnit),]
View(jointdataset)
View(Hier.data)
Hier.data
SUTab
#jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- inner_join(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
Hier.data <- Hier.data[order(Hier.data$SiteUnit),]
View(jointdataset)
#jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- inner_join(SUTab, Hier.data, by = "SiteUnit")
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
Hier.data <- Hier.data[order(Hier.data$SiteUnit),]
#jointdataset <- merge(Hier.data, SUTab, by = "SiteUnit")
jointdataset <- inner_join(SUTab, Hier.data, by = "SiteUnit")
jointdataset <- jointdataset[order(jointdataset$SiteUnit),]
Hier.data <- Hier.data[order(Hier.data$SiteUnit),]
View(jointdataset)
SUTab <- SUTab[order(SUTab$SiteUnit)]
View(SUTab)
uniqueLevels <- unique(Hier.data$level)
print(uniqueLevels)
level <- "Order"
uniqueLevels <- unique(Hier.data$level)
print(uniqueLevels)
uniqueLevels <- unique(Hier.data$[level])
uniqueLevels <- unique(Hier.data[level])
uniqueLevels <- unique(Hier.data[level,])
uniqueLevels <- unique(Hier.data[,level])
uniqueLevels <- unique(Hier.data[[level]])
print(uniqueLe)
print(uniqueLevels)
level_rows <- Heir.data %>% filter(level == level_name)
level_rows <- Hier.data %>% filter(level == level_name)
createReportData <- function(level_name) {
level_rows <- Hier.data %>% filter(level == level_name)
}
levelName <- unique_levels[[1]]
unique_levels <- unique(Hier.data[[level]])
levelName <- unique_levels[[1]]
createReportData(levelName)
createReportData <- function(level_name) {
level_rows <- Hier.data %>% filter(level == level_name)
print(level_rows)
}
levelName <- unique_levels[[1]]
createReportData(levelName)
levelName <- unique_levels[[2]]
createReportData(levelName)
levelName <- unique_levels[[44]]
levelName <- unique_levels[4]]
levelName <- unique_levels[[4]]
createReportData(levelName)
print(unique_levels)
level_rows <- Hier.data %>% filter(level == "ORDER Poputre" )
print(level_rows)
print(unique_levels)
level_rows <- Hier.data %>% filter("Order" == "ORDER Poputre" )
print(level_rows)
df2 %>% filter(SiteUnits == "A")
level_rows <- Hier.data %>% filter("Order" == "ORDER Poputre" )
print(level_rows)
Hier.data %> names()
Hier.data %>% names()
level_rows <- Hier.data %>% filter(Order == "ORDER Poputre" )
print(level_rows)
site_units <- level_rows$SiteUnit
site_units <- level_rows$SiteUnit
print(site_units)
site_units <- level_rows$SiteUnit
print(site_units)
site_units <- unique(level_rows$SiteUnit)
print(site_units)
sum(c(1,2,3))
SiteUnits_in_Order <- aggregate(SiteUnit ~ Order, data = Hier.data, unique)
View(SiteUnits_in_Order)
plot_numbers_in_level <- SUTab$PlotNumber[SUTab$SiteUnit %in% site_units$SiteUnit]
print(plot_numbers_in_level)
plot_numbers_in_level <- SUTab$PlotNumber[SUTab$SiteUnit %in% site_units$SiteUnit]
SUTab
level <- "Order"
unique_levels <- unique(Hier.data[[level]])
print(unique_levels)
level_rows <- Hier.data %>% filter(Order == "ORDER Poputre" )
site_units <- unique(level_rows$SiteUnit)
plot_numbers_in_level <- SUTab$PlotNumber[SUTab$SiteUnit %in% site_units$SiteUnit]
plot_numbers_in_level <- SUTab$PlotNumber[SUTab$SiteUnit %in% site_units]
print(plot_numbers_in_level)
View(vegDat_test)
View(vegSum2)
View(taxon.all)
View(Vpro.hier)
View(Hier.clean)
View(SS_good)
View(Hier.units)
Hier.units <- Hier.clean %>% dplyr::select(SiteUnit, Class, Order, Suborder, Alliance, Assoc) %>% distinct()
Hier.data <- left_join(Hier.units, SS_good) %>% filter(!is.na(nPlots)) %>% arrange(Species) %>% distinct()
View(Hier.data)
## ----some hierarchy stats---------------------------------------------------------------------------------------
classes <- unique(Hier.data$Class)
orders <- unique(Hier.data$Order)
suborders <- unique(Hier.data$Suborder)
suborders
class.dat <-
Hier.data %>% dplyr::select(SiteUnit, Suborder, Species, MeanCov) %>%
pivot_wider(id_cols = c(SiteUnit, Suborder),
names_from = Species,
values_from = MeanCov) %>%
mutate(Suborder = ifelse(is.na(Suborder) | Suborder == "", "unplaced", Suborder)) %>% filter(!SiteUnit == "") %>%  mutate_if(is.character, as.factor) %>%
replace(is.na(.),0) %>% distinct() %>% droplevels()
class.dat
View(class.dat)
class.dat <-
Hier.data %>% dplyr::select(SiteUnit, Suborder, Species, MeanCov) %>%
pivot_wider(id_cols = c(SiteUnit, Suborder),
names_from = Species,
values_from = MeanCov) %>%
mutate(Suborder = ifelse(is.na(Suborder) | Suborder == "", "unplaced", Suborder)) %>% filter(!SiteUnit == "") %>%  mutate_if(is.character, as.factor) %>%
replace(is.na(.),0) %>% distinct() %>% droplevels()
require(data.tree)
knitr::opts_chunk$set(echo = FALSE)
require(tidyverse)
require(tidymodels)
require(data.table)
require(data.tree)
require(DataExplorer)
require(C50)
require(indicspecies)
require(doParallel)
require(philentropy)
require(dplyr)
source("CodeUsingTreeFunctions.R")
source("./_functions/_TabletoTree.R")
source("./_functions/_TreetoTable.R")
source("./_functions/_VegdatSUsummary.R")
source("./_functions/_spp_importance.R")
head(Hier.data)
dim(Hier.data)
names(Hier.data)
sapply(Hier.data, function(x) length(unique(x)))
sapply(Hier.data, function(x) length(unique(x)))
